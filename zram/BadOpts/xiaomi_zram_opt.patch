From f0635b93665bf21caa47c3186bd8c7f67899ccc2 Mon Sep 17 00:00:00 2001
From: ztc1997 <dev@ztc1997.com>
Date: Sat, 11 May 2024 07:12:55 +0800
Subject: [PATCH] drivers: block: Import Xiaomi's zram optimization changes -
 From branch: `bsp-vermeer-t-oss`

Change-Id: I9ff6ebb63ad4e92e31d0c559ea0c554ec72c5118
---
 drivers/block/zram/zram_drv.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/block/zram/zram_drv.c b/drivers/block/zram/zram_drv.c
index 7916d5d62fe0..538bb53c769d 100644
--- a/drivers/block/zram/zram_drv.c
+++ b/drivers/block/zram/zram_drv.c
@@ -607,10 +607,10 @@ static int read_from_bdev_async(struct zram *zram, struct bio_vec *bvec,
 	}
 
 	if (!parent) {
-		bio->bi_opf = REQ_OP_READ;
+		bio->bi_opf = REQ_OP_READ | REQ_PRIO;
 		bio->bi_end_io = zram_page_end_io;
 	} else {
-		bio->bi_opf = parent->bi_opf;
+		bio->bi_opf = parent->bi_opf | REQ_PRIO;
 		bio_chain(bio, parent);
 	}
 
